"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[320],{6320:function(e,t,a){a.r(t),a.d(t,{default:function(){return y}});var r=a(7437),n=a(2265),i=a(73),s=a(5176),o=a(7862),l=a(9532),c=a(708);let d="0xaa36a7",u="https://ethereum-sepolia.publicnode.com",p="0x5aEdAaECA91934ae02225589FE810606e6ecb80b",m="0x1c7D4B196Cb0C7B01d743Fbc6116a902379C7238",h="0x8C799Ad986a4e826720955d39BF772ea035A4666",w=[{name:"balanceOf",type:"function",stateMutability:"view",inputs:[{name:"account",type:"address"}],outputs:[{type:"uint256"}]},{name:"approve",type:"function",stateMutability:"nonpayable",inputs:[{name:"spender",type:"address"},{name:"amount",type:"uint256"}],outputs:[{type:"bool"}]}],f=[{name:"depositToRemote",type:"function",stateMutability:"nonpayable",inputs:[{name:"value",type:"uint256"},{name:"remoteDomain",type:"uint32"},{name:"remoteRecipient",type:"bytes32"},{name:"localToken",type:"address"},{name:"maxFee",type:"uint256"},{name:"hookData",type:"bytes"}],outputs:[]}];function y(){let[e,t]=n.useState(null),[a,y]=n.useState("0"),[x,C]=n.useState("0"),[b,E]=n.useState(""),[v,N]=n.useState(""),[_,g]=n.useState(!1),[T,S]=n.useState(""),A=n.useMemo(()=>(0,i.v)({chain:c.F,transport:(0,s.d)(u)}),[]),k=async()=>{let e=window.ethereum;if(!e)throw Error("MetaMask not found");let t=await e.request({method:"eth_chainId"});if((null==t?void 0:t.toLowerCase())!==d){try{await e.request({method:"wallet_switchEthereumChain",params:[{chainId:d}]});return}catch(e){if((null==e?void 0:e.code)!==4902)throw e}try{await e.request({method:"wallet_addEthereumChain",params:[{chainId:d,chainName:"Sepolia",nativeCurrency:{name:"Sepolia Ether",symbol:"ETH",decimals:18},rpcUrls:[u].filter(Boolean),blockExplorerUrls:["https://sepolia.etherscan.io"]}]}),await e.request({method:"wallet_switchEthereumChain",params:[{chainId:d}]})}catch(e){throw Error("Please switch your wallet to Sepolia and try again.")}}},R=async()=>{if(!window.ethereum)throw Error("MetaMask not found");return await window.ethereum.request({method:"eth_requestAccounts"}),await k(),(0,o.K)({chain:c.F,transport:(0,l.P)(window.ethereum)})},D=n.useCallback(e=>{let t=e.match(/^0x([0-9a-fA-F]{40})$/);if(!t)throw Error("Invalid ETH address");return("0x"+"0".repeat(24)+t[1]).toLowerCase()},[]),U=(e,t)=>{if("string"!=typeof t||!/^0x[0-9a-fA-F]{40}$/.test(t))throw Error("".concat(e," is not set or invalid"))},j=()=>{if(!b)throw Error("Enter amount");let[e,t=""]=b.split(".");if(t.length>6)throw Error("USDC supports max 6 decimals");return BigInt(e+t.padEnd(6,"0"))};n.useEffect(()=>{if(h)try{N(D(h))}catch(e){}},[D]);let F=async()=>{try{let e=await R(),[a]=await e.getAddresses();t(a),S("Connected to Sepolia"),B(a)}catch(t){var e;S(null!==(e=t.message)&&void 0!==e?e:"Connect failed")}},B=async function(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:e;if(t)try{U("NEXT_PUBLIC_ETH_USDC_CONTRACT",m);let[e,a]=await Promise.all([A.getBalance({address:t}),A.readContract({address:m,abi:w,functionName:"balanceOf",args:[t]})]);y((Number(e)/1e18).toFixed(6)),C((Number(a)/1e6).toFixed(6))}catch(e){var a;S(null!==(a=e.message)&&void 0!==a?a:"Refresh failed")}},I=async()=>{try{if(g(!0),S("Approving USDC…"),!e)throw Error("Connect wallet first");U("NEXT_PUBLIC_X_RESERVE_CONTRACT",p),U("NEXT_PUBLIC_ETH_USDC_CONTRACT",m);let t=await R(),a=j(),r=await t.writeContract({account:e,address:m,abi:w,functionName:"approve",args:[p,a]});await A.waitForTransactionReceipt({hash:r}),S("Approval confirmed"),B()}catch(e){var t;S(null!==(t=e.message)&&void 0!==t?t:"Approval failed")}finally{g(!1)}},M=async()=>{try{if(g(!0),S("Depositing…"),!/^0x[0-9a-f]{64}$/.test(v))throw Error("Invalid bytes32 recipient");if(!e)throw Error("Connect wallet first");U("NEXT_PUBLIC_X_RESERVE_CONTRACT",p),U("NEXT_PUBLIC_ETH_USDC_CONTRACT",m);let t=await R(),a=j(),r=await t.writeContract({account:e,address:p,abi:f,functionName:"depositToRemote",args:[a,10003,v,m,0n,"0x"]});await A.waitForTransactionReceipt({hash:r}),S("Deposit confirmed"),B()}catch(e){var t;S(null!==(t=e.message)&&void 0!==t?t:"Deposit failed")}finally{g(!1)}};return(0,r.jsxs)("section",{className:"mt-10 p-4 border rounded-2xl",children:[(0,r.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Bridge USDC (Ethereum → Stacks)"}),e?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)("div",{className:"text-xs mb-2",children:[e.slice(0,6),"…",e.slice(-4)," (Sepolia)"]}),(0,r.jsxs)("div",{className:"text-xs mb-3",children:[(0,r.jsxs)("div",{children:["ETH: ",a]}),(0,r.jsxs)("div",{children:["USDC: ",x]})]}),(0,r.jsx)("input",{className:"w-full px-3 py-2 border rounded-xl mb-2",placeholder:"Amount (USDC)",value:b,onChange:e=>E(e.target.value)}),(0,r.jsx)("input",{className:"w-full px-3 py-2 border rounded-xl mb-3",placeholder:"remoteRecipient (bytes32)",value:v,onChange:e=>N(e.target.value)}),(0,r.jsxs)("div",{className:"flex gap-3",children:[(0,r.jsx)("button",{disabled:_,onClick:I,className:"flex-1 bg-gray-900 text-white py-2 rounded-xl disabled:opacity-50",children:"Approve"}),(0,r.jsx)("button",{disabled:_,onClick:M,className:"flex-1 bg-blue-600 text-white py-2 rounded-xl disabled:opacity-50",children:"Deposit"})]})]}):(0,r.jsx)("button",{onClick:F,className:"px-4 py-2 bg-purple-600 text-white rounded-xl",children:"Connect MetaMask"}),T&&(0,r.jsx)("div",{className:"mt-3 text-xs break-all",children:T})]})}}}]);